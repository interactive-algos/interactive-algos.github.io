<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Robot Measurement Demo</title>

    <script src='../general/js/utils.js'></script>
    <script src='../general/js/view.js'></script>
    <script src='../general/js/measurement.js'></script>
    <script src='../general/js/particle_filter.js'></script>
    <script src='../general/js/robot.js'></script>
    <script src='../general/js/particle.js'></script>
    <script src='js/measurement_beam_demo.js'></script>
    <script src='../general/js/map_data.js'></script>
    <style type="text/css">
        canvas { border: 1px solid black; }
    </style>

    <script>
        var measurementDemo;
        function init()
        {
			measurementDemo = new BeamModelDemo('canvas', getMap(), 3, 0.3);
        }

        function toggleColoring(event)
        {
        	const target = event.target || event.srcElement;
        	measurementDemo.setColoring(target.checked);
        }

        function parameterChanged(event)
        {
			const target = event.target || event.srcElement;
			const value = Number(target.value);
			if(target.id === 'nLasers')
            {
				measurementDemo.setNLasers(value+1);
            }else if(target.id === 'fogOfWar')
            {
            	measurementDemo.setSensorRadius(value);
            }else if(target.id === 'sensorNoise')
            {
            	measurementDemo.setSensorNoise(value);
            }else if(target.id === 'colorRes')
            {
            	measurementDemo.setColoringResolution(value);
            }
        }
    </script>
</head>
<body onload="init();">
<div class="container">
    <div class="row"><h3>Robot Measurement Beam Model</h3></div>

    <div class='row'>
			<span>
				<canvas id="canvas" width="700" height="400"></canvas>
			</span>
        <div style="float:right;">
            <fieldset>
                <legend>Configuration</legend>
                <table>
                    <tbody>
                        <tr>
                            <td>
                                <label for="nLasers">Number of Lasers</label>:
                            </td>
                            <td>
                                <input id="nLasers" onblur='return parameterChanged(event);' onkeypress='return isNumber(event);' class="form-control form-control-sm" value="18" size="4">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="fogOfWar">Sensor Radius</label>:
                            </td>
                            <td>
                                <input id="fogOfWar" onblur='return parameterChanged(event);' onkeypress='return isNumber(event);' class="form-control form-control-sm" value="3" size="4">m
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="sensorNoise">Sensor Noise</label>:
                            </td>
                            <td>
                                <input id="sensorNoise" onblur='return parameterChanged(event);' onkeypress='return isDecimal(event);' class="form-control form-control-sm" value="0.3" size="4">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="colorRes">Coloring Resolution</label>:
                            </td>
                            <td>
                                <input id="colorRes" onblur='return parameterChanged(event);' class="form-control form-control-sm" value="10" size="4">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label for="shouldColor">Color the Map</label>
                            </td>
                            <td>
                                <input id="shouldColor" onchange='return toggleColoring(event);' type="checkbox">
                            </td>
                        </tr>
                    </tbody>
                </table>

            </fieldset>
        </div>
    </div>
    <span id="probability"></span>
</div>
</body>
</html>
